"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
require("source-map-support/register");
var _rimraf = require("rimraf");
var _uuid = require("uuid");
var _path = _interopRequireDefault(require("path"));
var _os = _interopRequireDefault(require("os"));
var _promises = _interopRequireDefault(require("fs/promises"));
const commands = {};
commands.getScreenshot = async function getScreenshot() {
  const udid = this.requireUdid('io screenshot');
  const pathToScreenshotPng = _path.default.resolve(_os.default.tmpdir(), `${(0, _uuid.v4)()}.png`);
  try {
    await this.exec('io', {
      args: [udid, 'screenshot', pathToScreenshotPng]
    });
    return (await _promises.default.readFile(pathToScreenshotPng)).toString('base64');
  } finally {
    await (0, _rimraf.rimraf)(pathToScreenshotPng);
  }
};
var _default = commands;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmltcmFmIiwicmVxdWlyZSIsIl91dWlkIiwiX3BhdGgiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX29zIiwiX3Byb21pc2VzIiwiY29tbWFuZHMiLCJnZXRTY3JlZW5zaG90IiwidWRpZCIsInJlcXVpcmVVZGlkIiwicGF0aFRvU2NyZWVuc2hvdFBuZyIsInBhdGgiLCJyZXNvbHZlIiwib3MiLCJ0bXBkaXIiLCJ1dWlkVjQiLCJleGVjIiwiYXJncyIsImZzIiwicmVhZEZpbGUiLCJ0b1N0cmluZyIsInJpbXJhZiIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi9saWIvc3ViY29tbWFuZHMvaW8uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmltcmFmIH0gZnJvbSAncmltcmFmJztcbmltcG9ydCB7IHY0IGFzIHV1aWRWNCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgb3MgZnJvbSAnb3MnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzL3Byb21pc2VzJztcblxuY29uc3QgY29tbWFuZHMgPSB7fTtcblxuLyoqXG4gKiBHZXRzIGJhc2U2NCBzY3JlZW5zaG90IGZvciBkZXZpY2VcbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBzaW5jZSBYY29kZSBTREsgOC4xXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEJhc2U2NC1lbmNvZGVkIFNpbXVsYXRvciBzY3JlZW5zaG90LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBgdWRpZGAgaW5zdGFuY2UgcHJvcGVydHkgaXMgdW5zZXRcbiAqL1xuY29tbWFuZHMuZ2V0U2NyZWVuc2hvdCA9IGFzeW5jIGZ1bmN0aW9uIGdldFNjcmVlbnNob3QgKCkge1xuICBjb25zdCB1ZGlkID0gdGhpcy5yZXF1aXJlVWRpZCgnaW8gc2NyZWVuc2hvdCcpO1xuICBjb25zdCBwYXRoVG9TY3JlZW5zaG90UG5nID0gcGF0aC5yZXNvbHZlKG9zLnRtcGRpcigpLCBgJHt1dWlkVjQoKX0ucG5nYCk7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5leGVjKCdpbycsIHtcbiAgICAgIGFyZ3M6IFt1ZGlkLCAnc2NyZWVuc2hvdCcsIHBhdGhUb1NjcmVlbnNob3RQbmddLFxuICAgIH0pO1xuICAgIHJldHVybiAoYXdhaXQgZnMucmVhZEZpbGUocGF0aFRvU2NyZWVuc2hvdFBuZykpLnRvU3RyaW5nKCdiYXNlNjQnKTtcbiAgfSBmaW5hbGx5IHtcbiAgICBhd2FpdCByaW1yYWYocGF0aFRvU2NyZWVuc2hvdFBuZyk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNvbW1hbmRzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLEdBQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFLLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUVBLE1BQU1NLFFBQVEsR0FBRyxDQUFDLENBQUM7QUFZbkJBLFFBQVEsQ0FBQ0MsYUFBYSxHQUFHLGVBQWVBLGFBQWFBLENBQUEsRUFBSTtFQUN2RCxNQUFNQyxJQUFJLEdBQUcsSUFBSSxDQUFDQyxXQUFXLENBQUMsZUFBZSxDQUFDO0VBQzlDLE1BQU1DLG1CQUFtQixHQUFHQyxhQUFJLENBQUNDLE9BQU8sQ0FBQ0MsV0FBRSxDQUFDQyxNQUFNLENBQUMsQ0FBQyxFQUFHLEdBQUUsSUFBQUMsUUFBTSxFQUFDLENBQUUsTUFBSyxDQUFDO0VBQ3hFLElBQUk7SUFDRixNQUFNLElBQUksQ0FBQ0MsSUFBSSxDQUFDLElBQUksRUFBRTtNQUNwQkMsSUFBSSxFQUFFLENBQUNULElBQUksRUFBRSxZQUFZLEVBQUVFLG1CQUFtQjtJQUNoRCxDQUFDLENBQUM7SUFDRixPQUFPLENBQUMsTUFBTVEsaUJBQUUsQ0FBQ0MsUUFBUSxDQUFDVCxtQkFBbUIsQ0FBQyxFQUFFVSxRQUFRLENBQUMsUUFBUSxDQUFDO0VBQ3BFLENBQUMsU0FBUztJQUNSLE1BQU0sSUFBQUMsY0FBTSxFQUFDWCxtQkFBbUIsQ0FBQztFQUNuQztBQUNGLENBQUM7QUFBQyxJQUFBWSxRQUFBLEdBRWFoQixRQUFRO0FBQUFpQixPQUFBLENBQUFDLE9BQUEsR0FBQUYsUUFBQSJ9